
## React的架构
react是函数式+不可变数据的一个框架，它的设计模式是modal to view，单向数据流。在具体的数据结构上，是以fiber为基本节点，在其中承载了组件的一些数据和行为，然后由一个又一个fiber组成链表，每个fiber又保存着指向兄弟节点和父子节点的指针，拥有着层次结构，最终就形成了一个fiber tree。

react的数据驱动视图的逻辑，都是基于这个fiber tree去实现的。它大致分为两个阶段，一个协调阶段，一个是提交阶段。在协调阶段，会遍历fiber tree，执行更新调度，对render进行diff逻辑，最终收集副作用，去进行提交。

在提交阶段，会执行一些生命周期方法，然后挂载节点。

在整个协调中，会采用时间分片的方法，在浏览器一帧中的空余时间去执行处理，并且随时可以中断恢复，不阻塞渲染进程，最后再进行提交，这样就能极大的优化了渲染的性能。

## React 的编程思想
他的编程思想我概括一下：
- 简单
- 灵活
- 粒度更细，组件化更彻底

在react中，modal层和view层是可以解耦的。对于逻辑组件，只需要描述数据模型本身，决定入参和输出是什么，而没有多余的外部依赖和副作用，形成一个干净和透明的纯函数。

对于视图组件，也只有props这一个外部输入，没有内部状态，形成一个受控模式。
形成有状态无渲染，有渲染无状态。整个数据流清晰透明，这个就是react比较推荐的一种编程哲学。

然后再说到react hooks

## React 为什么是 Immutale


## React hooks 的优点

### 粒度更细

- 从class的一个总的state状态，拆分为单独的一个个更细粒度的state，并使得“状态”与“变更状态的逻辑”两两配对，这样就能更加灵活的去控制。

### 从命令式变成声明式

对于某个功能，我们通常需要在挂载后，状态变更后，组件卸载前进行调用。如果用class的声明周期，那就分别需要在componentDidMount,componentDidUpdate,ComponentWillUnmount，这三处地方去写逻辑。相比起来，使用hook的话只需要在useEffect这一个地方做处理。会在效率上和可维护性上远高于class

### 数据和视图解耦

react class，其实只是UI框架，状态和视图耦合在一块，一切都是为视图而服务，没有独立的一层model。

很多本该由 service层，model层去做的事情，都放在了view层去做。导致view层在处理前端交互的同时，还要去处理业务逻辑，与接口通信。代码耦合性严重，不利于复用。

## Hooks 与 Class 的区别
hooks把对象这个概念瓦解了。

在class中，有构造函数一些数据初始化，有method方法和生命周期方法作为一个行为，数据和行为之间也能进行关联。

但实际上，数据——行为——关联是三个维度，他们可以不被捆绑在一个对象中。

在hooks里，数据可以单独声明（useState），行为也可以单独声明（useEffect），数据和行为可以进行可选的关联（custom-hooks）。并且数据可以单独组合，行为可以单独组合，组合的数据和组合的行为可以进行再度组合。组合的维度得到了横向和纵向的自由度扩展。

这个就是hooks与class的区别。